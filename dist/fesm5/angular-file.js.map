{"version":3,"file":"angular-file.js","sources":["ng://angular-file/file-upload/doc-event-help.functions.ts","ng://angular-file/file-upload/fileTools.ts","ng://angular-file/file-upload/ngf.directive.ts","ng://angular-file/file-upload/ngfSelect.directive.ts","ng://angular-file/file-upload/ngfDrop.directive.ts","ng://angular-file/file-upload/ngfBackground.directive.ts","ng://angular-file/file-upload/ngfUploadStatus.directive.ts","ng://angular-file/file-upload/ngfFormData.directive.ts","ng://angular-file/file-upload/ngfSrc.directive.ts","ng://angular-file/file-upload/ngf.module.ts","ng://angular-file/public-api.ts","ng://angular-file/angular-file.ts"],"sourcesContent":["export const isFileInput = function(elm:any){\r\n  const ty = elm.getAttribute('type')\r\n  return elm.tagName.toLowerCase() === 'input' && ty && ty.toLowerCase() === 'file';\r\n}\r\n\r\nlet initialTouchStartY = 0;\r\nlet initialTouchStartX = 0;\r\nexport const detectSwipe = function(evt:any):boolean {\r\n  var touches = evt.changedTouches || (evt.originalEvent && evt.originalEvent.changedTouches);\r\n  if (touches) {\r\n    if (evt.type === 'touchstart') {\r\n      initialTouchStartX = touches[0].clientX;\r\n      initialTouchStartY = touches[0].clientY;\r\n      return true; // don't block event default\r\n    } else {\r\n      // prevent scroll from triggering event\r\n      if (evt.type === 'touchend') {\r\n        var currentX = touches[0].clientX;\r\n        var currentY = touches[0].clientY;\r\n        if ((Math.abs(currentX - initialTouchStartX) > 20) ||\r\n          (Math.abs(currentY - initialTouchStartY) > 20)) {\r\n          evt.stopPropagation();\r\n          evt.preventDefault();\r\n          return false;\r\n        }\r\n      }\r\n      return true;\r\n    }\r\n  }\r\n  return false\r\n}\r\n\r\nexport const createInvisibleFileInputWrap = function() {\r\n  var fileElem = createFileInput()\r\n  var label = document.createElement('label');\r\n  label.innerHTML = 'upload'\r\n  label.style.visibility = 'hidden'\r\n  label.style.position = 'absolute'\r\n  label.style.overflow = 'hidden'\r\n  label.style.width = '0px'\r\n  label.style.height = '0px'\r\n  label.style.border = 'none'\r\n  label.style.margin = '0px'\r\n  label.style.padding = '0px'\r\n  label.setAttribute('tabindex','-1')\r\n  \r\n  //bindAttrToFileInput(fileElem, label);\r\n  //generatedElems.push({el: elem, ref: label});\r\n\r\n  label.appendChild( fileElem )\r\n  //document.body.appendChild( label );\r\n\r\n  return label;\r\n}\r\n\r\nexport const createFileInput = function() {\r\n  var fileElem = document.createElement('input');\r\n  fileElem.type=\"file\"\r\n  return fileElem;\r\n}","export function getWindow():any{return window}\r\n\r\nexport function acceptType(accept:string, type:string, name?:string):boolean {   \r\n  if( !accept ){\r\n    return true\r\n  }\r\n\r\n  const defs = accept.split(',')\r\n  let regx:RegExp\r\n  let acceptRegString:string\r\n\r\n  for(let x=defs.length-1; x >= 0; --x){\r\n    //Escapes dots in mimetype \r\n    acceptRegString = defs[x]\r\n    //trim\r\n    acceptRegString = acceptRegString.replace(/(^\\s+|\\s+$)/g,'')\r\n    //Escapes stars in mimetype \r\n    acceptRegString = acceptRegString.replace(/\\*/g,'.*')\r\n    //let acceptReg = '^((' + acceptRegString\r\n    //acceptReg = acceptReg.replace(/,/g,')|(') + '))$'\r\n    \r\n    //try by mime\r\n    regx = new RegExp(acceptRegString, 'gi')\r\n    if( type.search(regx)>=0 ){\r\n      return true\r\n    }\r\n\r\n    //try by ext\r\n    if( acceptRegString.substring(0, 1)=='.' ){      \r\n      acceptRegString = '\\\\'+ acceptRegString//.substring(1, acceptRegString.length-1)//remove dot at front\r\n      regx = new RegExp(acceptRegString+'$', 'i')\r\n      if( (name||type).search(regx)>=0 ){\r\n        return true\r\n      }\r\n    }\r\n  }\r\n  return false\r\n}\r\n\r\nexport interface InvalidFileItem{\r\n  file:File\r\n  type:string\r\n}\r\n\r\nexport function arrayBufferToBase64(buffer:any) {\r\n  var binary = '';\r\n  var bytes = new Uint8Array(buffer);\r\n  var len = bytes.byteLength;\r\n  for (var i = 0; i < len; i++) {\r\n    binary += String.fromCharCode(bytes[i]);\r\n  }\r\n  return window.btoa(binary);\r\n}\r\n\r\nexport function dataUrltoBlob(\r\n  dataurl:string,\r\n  name:string,\r\n  origSize?:any\r\n):Blob{\r\n  var arr = dataurl.split(',');\r\n  var mimeMatch = arr[0].match(/:(.*?);/)\r\n  var mime:string = mimeMatch ? mimeMatch[1] : 'text/plain'\r\n  var bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);\r\n  while (n--) {\r\n    u8arr[n] = bstr.charCodeAt(n);\r\n  }\r\n  var blob = new window.Blob([u8arr], {type: mime});\r\n  blob[\"name\"] = name;\r\n  blob[\"$ngfOrigSize\"] = origSize;\r\n  return blob;\r\n}\r\n\r\nexport interface orientationMeta{\r\n  orientation: number\r\n  fixedArrayBuffer?:any[]\r\n}\r\n\r\nexport function applyTransform(\r\n  ctx:CanvasRenderingContext2D,\r\n  orientation:number,\r\n  width:number,\r\n  height:number\r\n) {\r\n  switch (orientation) {\r\n    case 2:\r\n      return ctx.transform(-1, 0, 0, 1, width, 0);\r\n    case 3:\r\n      return ctx.transform(-1, 0, 0, -1, width, height);\r\n    case 4:\r\n      return ctx.transform(1, 0, 0, -1, 0, height);\r\n    case 5:\r\n      return ctx.transform(0, 1, 1, 0, 0, 0);\r\n    case 6:\r\n      return ctx.transform(0, 1, -1, 0, height, 0);\r\n    case 7:\r\n      return ctx.transform(0, -1, -1, 0, height, width);\r\n    case 8:\r\n      return ctx.transform(0, -1, 1, 0, 0, width);\r\n  }\r\n}\r\n\r\nexport function fixFileOrientationByMeta(\r\n  file:File, result:orientationMeta\r\n):Promise<File>{\r\n  return dataUrl(file, true)\r\n  .then(url=>{\r\n    var canvas = document.createElement('canvas');\r\n    var img = document.createElement('img');\r\n\r\n    return <Promise<File>>new Promise(function(res,rej){\r\n      img.onload = function () {\r\n        try {\r\n          canvas.width = result.orientation > 4 ? img.height : img.width\r\n          canvas.height = result.orientation > 4 ? img.width : img.height\r\n          var ctx = <CanvasRenderingContext2D>canvas.getContext('2d')\r\n          applyTransform(ctx, result.orientation, img.width, img.height)\r\n          ctx.drawImage(img, 0, 0);\r\n          var dataUrl = canvas.toDataURL(file.type || 'image/WebP', 0.934)\r\n          const base = arrayBufferToBase64(result.fixedArrayBuffer)\r\n          dataUrl = restoreExif(base, dataUrl)\r\n          var blob = dataUrltoBlob(dataUrl, file.name)\r\n          const newFile = blobToFile(blob, file.name);\r\n          res(newFile);\r\n        } catch (e) {\r\n          rej(e)\r\n        }\r\n      };\r\n      img.onerror = rej;\r\n      img.src = url;    \r\n    })\r\n  })\r\n}\r\n\r\nexport function applyExifRotation(\r\n  file:File\r\n):Promise<File>{\r\n  if (file.type.indexOf('image/jpeg') !== 0) {\r\n    return Promise.resolve(file);\r\n  }\r\n\r\n  return readOrientation(file)\r\n  .then((result:orientationMeta)=>{\r\n    if (result.orientation < 2 || result.orientation > 8) {\r\n      return file\r\n    }\r\n    \r\n    return fixFileOrientationByMeta(file,result)\r\n  })\r\n}\r\n\r\nexport function readOrientation(\r\n  file:File\r\n):Promise<orientationMeta>{\r\n  return new Promise((res,rej)=>{\r\n    var reader = new FileReader();\r\n    var slicedFile = file.slice ? file.slice(0, 64 * 1024) : file;\r\n    reader.readAsArrayBuffer(slicedFile);\r\n    reader.onerror = rej\r\n    reader.onload = function (e:any) {\r\n      var result:orientationMeta = {orientation: 1};\r\n      var view = new DataView( <ArrayBuffer>this.result );\r\n      if (view.getUint16(0, false) !== 0xFFD8) return res(result);\r\n\r\n      var length = view.byteLength,\r\n        offset = 2;\r\n      while (offset < length) {\r\n        var marker = view.getUint16(offset, false);\r\n        offset += 2;\r\n        if (marker === 0xFFE1) {\r\n          if (view.getUint32(offset += 2, false) !== 0x45786966) return res(result);\r\n\r\n          var little = view.getUint16(offset += 6, false) === 0x4949;\r\n          offset += view.getUint32(offset + 4, little);\r\n          var tags = view.getUint16(offset, little);\r\n          offset += 2;\r\n          for (var i = 0; i < tags; i++)\r\n            if (view.getUint16(offset + (i * 12), little) === 0x0112) {\r\n              var orientation = view.getUint16(offset + (i * 12) + 8, little);\r\n              if (orientation >= 2 && orientation <= 8) {\r\n                view.setUint16(offset + (i * 12) + 8, 1, little);\r\n                result.fixedArrayBuffer = e.target.result;\r\n              }\r\n              result.orientation = orientation;\r\n              return res(result);\r\n            }\r\n        } else if ((marker & 0xFF00) !== 0xFF00) break;\r\n        else offset += view.getUint16(offset, false);\r\n      }\r\n      return res(result);\r\n    };\r\n  })\r\n}\r\n\r\n/** converts file-input file into base64 dataUri */\r\nexport function dataUrl(\r\n  file:any,\r\n  disallowObjectUrl?:any\r\n):Promise<string>{\r\n  if (!file) return Promise.resolve(file)\r\n  \r\n  if ((disallowObjectUrl && file.$ngfDataUrl != null) || (!disallowObjectUrl && file.$ngfBlobUrl != null)) {\r\n    return Promise.resolve( disallowObjectUrl ? file.$ngfDataUrl : file.$ngfBlobUrl )\r\n  }\r\n\r\n  var p = disallowObjectUrl ? file.$$ngfDataUrlPromise : file.$$ngfBlobUrlPromise;\r\n  if (p) return p;\r\n\r\n  const win = getWindow()\r\n  let deferred:Promise<string>\r\n  if (win.FileReader && file &&\r\n    (!win.FileAPI || navigator.userAgent.indexOf('MSIE 8') === -1 || file.size < 20000) &&\r\n    (!win.FileAPI || navigator.userAgent.indexOf('MSIE 9') === -1 || file.size < 4000000)) {\r\n    //prefer URL.createObjectURL for handling refrences to files of all sizes\r\n    //since it doesnÂ´t build a large string in memory\r\n    var URL = win.URL || win.webkitURL;\r\n    if (FileReader) {\r\n      deferred = new Promise((res,rej)=>{\r\n        var fileReader = new FileReader();\r\n        fileReader.onload = function (event:any) {\r\n          file.$ngfDataUrl = event.target.result;\r\n          delete file.$ngfDataUrl;\r\n          res( event.target.result )\r\n        };\r\n        fileReader.onerror = function (e) {\r\n          file.$ngfDataUrl = '';\r\n          rej(e)\r\n        };\r\n        fileReader.readAsDataURL(file);\r\n      })\r\n    } else {\r\n      var url:any;\r\n      try {\r\n        url = URL.createObjectURL(file);\r\n      } catch (e) {\r\n        return Promise.reject(e);\r\n      }\r\n      \r\n      deferred = Promise.resolve( url )\r\n      file.$ngfBlobUrl = url;\r\n    }\r\n  } else {\r\n    file[disallowObjectUrl ? '$ngfDataUrl' : '$ngfBlobUrl'] = '';\r\n    return Promise.reject( new Error('Browser does not support window.FileReader, window.FileReader, or window.FileAPI') )//deferred.reject();\r\n  }\r\n\r\n  if (disallowObjectUrl) {\r\n    p = file.$$ngfDataUrlPromise = deferred;\r\n  } else {\r\n    p = file.$$ngfBlobUrlPromise = deferred;\r\n  }\r\n\r\n  p = p.then((x:any)=>{\r\n    delete file[disallowObjectUrl ? '$$ngfDataUrlPromise' : '$$ngfBlobUrlPromise'];\r\n    return x\r\n  })\r\n\r\n  return p;\r\n}\r\n\r\nexport function restoreExif(orig:any, resized:any) {\r\n  var ExifRestorer:any = {\r\n    KEY_STR:'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='\r\n  }\r\n\r\n  ExifRestorer.encode64 = function (input:any) {\r\n    var output = '',\r\n      chr1, chr2, chr3:any = '',\r\n      enc1, enc2, enc3, enc4:any = '',\r\n      i = 0;\r\n\r\n    do {\r\n      chr1 = input[i++];\r\n      chr2 = input[i++];\r\n      chr3 = input[i++];\r\n\r\n      enc1 = chr1 >> 2;\r\n      enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);\r\n      enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);\r\n      enc4 = chr3 & 63;\r\n\r\n      if (isNaN(chr2)) {\r\n        enc3 = enc4 = 64;\r\n      } else if (isNaN(chr3)) {\r\n        enc4 = 64;\r\n      }\r\n\r\n      output = output +\r\n        this.KEY_STR.charAt(enc1) +\r\n        this.KEY_STR.charAt(enc2) +\r\n        this.KEY_STR.charAt(enc3) +\r\n        this.KEY_STR.charAt(enc4);\r\n      chr1 = chr2 = chr3 = '';\r\n      enc1 = enc2 = enc3 = enc4 = '';\r\n    } while (i < input.length);\r\n\r\n    return output;\r\n  };\r\n\r\n  ExifRestorer.restore = function (origFileBase64:any, resizedFileBase64:any) {\r\n    if (origFileBase64.match('data:image/jpeg;base64,')) {\r\n      origFileBase64 = origFileBase64.replace('data:image/jpeg;base64,', '');\r\n    }\r\n\r\n    var rawImage:number[] = this.decode64(origFileBase64);\r\n    var segments = this.slice2Segments(rawImage);\r\n\r\n    var image = this.exifManipulation(resizedFileBase64, segments);\r\n\r\n    return 'data:image/jpeg;base64,' + this.encode64(image);\r\n  };\r\n\r\n\r\n  ExifRestorer.exifManipulation = function (resizedFileBase64:any, segments:any) {\r\n    var exifArray = this.getExifArray(segments),\r\n      newImageArray = this.insertExif(resizedFileBase64, exifArray);\r\n    return new Uint8Array(newImageArray);\r\n  };\r\n\r\n  ExifRestorer.getExifArray = function (segments:number[][]) {\r\n    var seg;\r\n    for (var x = 0; x < segments.length; x++) {\r\n      seg = segments[x];\r\n      if (seg[0] === 255 && seg[1] === 225) //(ff e1)\r\n      {\r\n        return seg;\r\n      }\r\n    }\r\n    return [];\r\n  };\r\n\r\n\r\n  ExifRestorer.insertExif = function (resizedFileBase64:any, exifArray:any) {\r\n    var imageData = resizedFileBase64.replace('data:image/jpeg;base64,', ''),\r\n      buf = this.decode64(imageData),\r\n      separatePoint = buf.indexOf(255, 3),\r\n      mae = buf.slice(0, separatePoint),\r\n      ato = buf.slice(separatePoint),\r\n      array = mae;\r\n\r\n    array = array.concat(exifArray);\r\n    array = array.concat(ato);\r\n    return array;\r\n  };\r\n\r\n\r\n  ExifRestorer.slice2Segments = function(\r\n    rawImageArray:number[]\r\n  ) {\r\n    var head:number = 0,\r\n      segments:number[][] = [];\r\n\r\n    while (1) {\r\n      if (rawImageArray[head] === 255 && rawImageArray[head + 1] === 218) {\r\n        break;\r\n      }\r\n      if (rawImageArray[head] === 255 && rawImageArray[head + 1] === 216) {\r\n        head += 2;\r\n      }\r\n      else {\r\n        var length = rawImageArray[head + 2] * 256 + rawImageArray[head + 3]\r\n        var endPoint = head + length + 2\r\n        var seg:number[] = rawImageArray.slice(head, endPoint)\r\n        segments.push(seg);\r\n        head = endPoint;\r\n      }\r\n      if (head > rawImageArray.length) {\r\n        break;\r\n      }\r\n    }\r\n\r\n    return segments;\r\n  };\r\n\r\n\r\n  ExifRestorer.decode64 = function (\r\n    input:any\r\n  ):number[]{\r\n    var chr1, chr2, chr3:any = '',\r\n      enc1, enc2, enc3, enc4:any = '',\r\n      i = 0,\r\n      buf:number[] = [];\r\n\r\n    // remove all characters that are not A-Z, a-z, 0-9, +, /, or =\r\n    var base64test = /[^A-Za-z0-9\\+\\/\\=]/g;\r\n    if (base64test.exec(input)) {\r\n      console.log('There were invalid base64 characters in the input text.');\r\n    }\r\n    input = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, '');\r\n\r\n    do {\r\n      enc1 = this.KEY_STR.indexOf(input.charAt(i++));\r\n      enc2 = this.KEY_STR.indexOf(input.charAt(i++));\r\n      enc3 = this.KEY_STR.indexOf(input.charAt(i++));\r\n      enc4 = this.KEY_STR.indexOf(input.charAt(i++));\r\n\r\n      chr1 = (enc1 << 2) | (enc2 >> 4);\r\n      chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);\r\n      chr3 = ((enc3 & 3) << 6) | enc4;\r\n\r\n      buf.push(chr1);\r\n\r\n      if (enc3 !== 64) {\r\n        buf.push(chr2);\r\n      }\r\n      if (enc4 !== 64) {\r\n        buf.push(chr3);\r\n      }\r\n\r\n      chr1 = chr2 = chr3 = '';\r\n      enc1 = enc2 = enc3 = enc4 = '';\r\n\r\n    } while (i < input.length);\r\n\r\n    return buf;\r\n  };\r\n\r\n  return ExifRestorer.restore(orig, resized);  //<= EXIF\r\n};\r\n\r\nfunction blobToFile(theBlob: Blob, fileName:string): File {\r\n  var b: any = theBlob;\r\n  //A Blob() is almost a File() - it's just missing the two properties below which we will add\r\n  b.lastModifiedDate = new Date();\r\n  b.name = fileName;\r\n\r\n  //Cast to a File() type\r\n  return <File>theBlob;\r\n}\r\n","import { Directive, EventEmitter, ElementRef, Input, Output, HostListener } from '@angular/core';\r\nimport { createInvisibleFileInputWrap, isFileInput, detectSwipe } from \"./doc-event-help.functions\"\r\nimport {\r\n  acceptType, InvalidFileItem,\r\n  applyExifRotation, dataUrl\r\n} from \"./fileTools\"\r\n\r\nexport interface dragMeta{\r\n  type:string\r\n  kind:string\r\n}\r\n\r\n/** A master base set of logic intended to support file select/drag/drop operations\r\n NOTE: Use ngfDrop for full drag/drop. Use ngfSelect for selecting\r\n*/\r\n@Directive({\r\n  selector: \"[ngf]\",\r\n  exportAs:\"ngf\"\r\n})\r\nexport class ngf {\r\n  fileElm:any\r\n  filters:{name:string, fn:(file:File)=>boolean}[] = []\r\n  lastFileCount:number=0\r\n\r\n  @Input() multiple !:string\r\n  @Input() accept   !:string\r\n  @Input() maxSize  !:number\r\n  //@Input() forceFilename:string\r\n  //@Input() forcePostname:string\r\n  @Input() ngfFixOrientation:boolean = true\r\n\r\n  @Input() fileDropDisabled:boolean = false\r\n  @Input() selectable:boolean = false\r\n  @Output('init') directiveInit:EventEmitter<ngf> = new EventEmitter()\r\n  \r\n  @Input() lastInvalids:InvalidFileItem[] = []\r\n  @Output() lastInvalidsChange:EventEmitter<{file:File,type:string}[]> = new EventEmitter()\r\n\r\n  @Input() lastBaseUrl !: string//base64 last file uploaded url\r\n  @Output() lastBaseUrlChange:EventEmitter<string> = new EventEmitter()\r\n  \r\n  @Input() file !: File//last file uploaded\r\n  @Output() fileChange:EventEmitter<File> = new EventEmitter()\r\n\r\n  @Input() files:File[] = []\r\n  @Output() filesChange:EventEmitter<File[]> = new EventEmitter<File[]>();\r\n\r\n  constructor(public element:ElementRef){\r\n    this.initFilters()\r\n  }\r\n\r\n  initFilters(){\r\n    // the order is important\r\n    this.filters.push({name: 'accept', fn: this._acceptFilter})\r\n    this.filters.push({name: 'fileSize', fn: this._fileSizeFilter})\r\n\r\n    //this.filters.push({name: 'fileType', fn: this._fileTypeFilter})\r\n    //this.filters.push({name: 'queueLimit', fn: this._queueLimitFilter})\r\n    //this.filters.push({name: 'mimeType', fn: this._mimeTypeFilter})\r\n  }\r\n\r\n  ngOnDestroy(){\r\n    delete this.fileElm//faster memory release of dom element\r\n  }\r\n\r\n  ngOnInit(){\r\n    if( this.selectable ){\r\n      this.enableSelecting()\r\n    }\r\n\r\n    if( this.multiple ){\r\n      this.paramFileElm().setAttribute('multiple', this.multiple)\r\n    }\r\n\r\n    //create reference to this class with one cycle delay to avoid ExpressionChangedAfterItHasBeenCheckedError\r\n    setTimeout(()=>{\r\n      this.directiveInit.emit(this)\r\n    }, 0)\r\n  }\r\n\r\n  ngOnChanges( changes ){\r\n    if( changes.accept ){\r\n      this.paramFileElm().setAttribute('accept', changes.accept.currentValue || '*')\r\n    }\r\n  }\r\n\r\n  paramFileElm(){\r\n    if( this.fileElm )return this.fileElm//already defined\r\n    \r\n    //elm is a file input\r\n    const isFile = isFileInput( this.element.nativeElement )\r\n    if(isFile)return this.fileElm = this.element.nativeElement\r\n    \r\n    //create foo file input\r\n    const label = createInvisibleFileInputWrap()\r\n    this.fileElm = label.getElementsByTagName('input')[0]\r\n    this.fileElm.addEventListener('change', this.changeFn.bind(this));\r\n    this.element.nativeElement.appendChild( label )\r\n    return this.fileElm\r\n  }\r\n\r\n  enableSelecting(){\r\n    let elm = this.element.nativeElement\r\n\r\n    if( isFileInput(elm) ){\r\n      const bindedHandler = _ev=>this.beforeSelect()\r\n      elm.addEventListener('click', bindedHandler)\r\n      elm.addEventListener('touchstart', bindedHandler)\r\n      return\r\n    }\r\n\r\n    const bindedHandler = ev=>this.clickHandler(ev)\r\n    elm.addEventListener('click', bindedHandler)\r\n    elm.addEventListener('touchstart', bindedHandler)\r\n    elm.addEventListener('touchend', bindedHandler)\r\n  }\r\n\r\n  getValidFiles( files:File[] ):File[]{\r\n    const rtn:File[] = []\r\n    for(let x=files.length-1; x >= 0; --x){\r\n      if( this.isFileValid(files[x]) ){\r\n        rtn.push( files[x] )\r\n      }\r\n    }\r\n    return rtn\r\n  }\r\n\r\n  getInvalidFiles(files:File[]):InvalidFileItem[]{\r\n    const rtn:InvalidFileItem[] = []\r\n    for(let x=files.length-1; x >= 0; --x){\r\n      let failReason = this.getFileFilterFailName(files[x])\r\n      if( failReason ){\r\n        rtn.push({\r\n          file : files[x],\r\n          type : failReason\r\n        })\r\n      }\r\n    }\r\n    return rtn\r\n  }\r\n\r\n  handleFiles(files:File[]){\r\n    const valids = this.getValidFiles(files)\r\n\r\n    if(files.length!=valids.length){\r\n      this.lastInvalids = this.getInvalidFiles(files)\r\n    }else{\r\n      delete this.lastInvalids\r\n    }\r\n    \r\n    this.lastInvalidsChange.emit(this.lastInvalids)\r\n\r\n    if( valids.length ){\r\n      if( this.ngfFixOrientation ){\r\n        this.applyExifRotations(valids)\r\n        .then( fixedFiles=>this.que(fixedFiles) )\r\n      }else{\r\n        this.que(valids)\r\n      }\r\n    }\r\n\r\n    if (this.isEmptyAfterSelection()) {\r\n      this.element.nativeElement.value = ''\r\n    }\r\n  }\r\n\r\n  que( files:File[] ){\r\n    this.files = this.files || []\r\n    Array.prototype.push.apply(this.files, files)\r\n\r\n    //below break memory ref and doesnt act like a que\r\n    //this.files = files//causes memory change which triggers bindings like <ngfFormData [files]=\"files\"></ngfFormData>\r\n    \r\n    this.filesChange.emit( this.files )\r\n\r\n    if(files.length){\r\n      this.fileChange.emit( this.file=files[0] )\r\n\r\n      if(this.lastBaseUrlChange.observers.length){\r\n        dataUrl( files[0] )\r\n        .then( url=>this.lastBaseUrlChange.emit(url) )\r\n      }\r\n    }\r\n\r\n    //will be checked for input value clearing\r\n    this.lastFileCount = this.files.length\r\n  }\r\n\r\n  /** called when input has files */\r\n  changeFn(event:any) {\r\n    var fileList = event.__files_ || (event.target && event.target.files)\r\n\r\n    if (!fileList) return;\r\n\r\n    this.stopEvent(event);\r\n    this.handleFiles(fileList)\r\n  }\r\n\r\n  clickHandler(evt:any){\r\n    const elm = this.element.nativeElement\r\n    if (elm.getAttribute('disabled') || this.fileDropDisabled){\r\n      return false;\r\n    }\r\n    \r\n    var r = detectSwipe(evt);\r\n    // prevent the click if it is a swipe\r\n    if ( r!==false ) return r;\r\n\r\n    const fileElm = this.paramFileElm()\r\n    fileElm.click()\r\n    //fileElm.dispatchEvent( new Event('click') );\r\n    this.beforeSelect()\r\n\r\n    return false;\r\n  }\r\n\r\n  beforeSelect(){\r\n    if( this.files && this.lastFileCount===this.files.length )return\r\n\r\n    //if no files in array, be sure browser doesnt prevent reselect of same file (see github issue 27)\r\n    this.fileElm.value = null\r\n  }\r\n\r\n  isEmptyAfterSelection():boolean {\r\n    return !!this.element.nativeElement.attributes.multiple;\r\n  }\r\n\r\n  eventToTransfer(event:any):any {\r\n    if(event.dataTransfer)return event.dataTransfer\r\n    return  event.originalEvent ? event.originalEvent.dataTransfer : null\r\n  }\r\n\r\n  stopEvent(event:any):any {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n  }\r\n\r\n  transferHasFiles(transfer:any):any {\r\n    if (!transfer.types) {\r\n      return false;\r\n    }\r\n\r\n    if (transfer.types.indexOf) {\r\n      return transfer.types.indexOf('Files') !== -1;\r\n    } else if (transfer.types.contains) {\r\n      return transfer.types.contains('Files');\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  eventToFiles(event:Event){\r\n    const transfer = this.eventToTransfer(event);\r\n    if( transfer ){\r\n      if(transfer.files && transfer.files.length){\r\n        return transfer.files\r\n      }\r\n      if(transfer.items && transfer.items.length){\r\n        return transfer.items\r\n      }\r\n    }\r\n    return []\r\n  }\r\n\r\n  applyExifRotations(\r\n    files:File[]\r\n  ):Promise<File[]>{\r\n    const mapper = (\r\n      file:File,index:number\r\n    ):Promise<any>=>{\r\n      return applyExifRotation(file)\r\n      .then( fixedFile=>files.splice(index, 1, fixedFile) )\r\n    }\r\n\r\n    const proms:Promise<any>[] = []\r\n    for(let x=files.length-1; x >= 0; --x){\r\n      proms[x] = mapper( files[x], x )\r\n    }\r\n    return Promise.all( proms ).then( ()=>files )\r\n  }\r\n\r\n  @HostListener('change', ['$event'])\r\n  onChange(event:Event):void {\r\n    let files = this.element.nativeElement.files || this.eventToFiles(event)\r\n\r\n    if(!files.length)return\r\n\r\n    this.stopEvent(event);\r\n    this.handleFiles(files)\r\n  }\r\n\r\n  getFileFilterFailName(\r\n    file:File\r\n  ):string | undefined{\r\n    for(let i = 0; i < this.filters.length; i++){\r\n      if( !this.filters[i].fn.call(this, file) ){\r\n        return this.filters[i].name\r\n      }\r\n    }\r\n    return undefined\r\n  }\r\n\r\n  isFileValid(file:File):boolean{\r\n    const noFilters = !this.accept && (!this.filters || !this.filters.length)\r\n    if( noFilters ){\r\n      return true//we have no filters so all files are valid\r\n    }\r\n    \r\n    return this.getFileFilterFailName(file) ? false : true\r\n  }\r\n\r\n  isFilesValid(files:File[]){\r\n    for(let x=files.length-1; x >= 0; --x){\r\n      if( !this.isFileValid(files[x]) ){\r\n        return false\r\n      }\r\n    }\r\n    return true\r\n  }\r\n  \r\n  protected _acceptFilter(item:File):boolean {\r\n    return acceptType(this.accept, item.type, item.name)\r\n  }\r\n\r\n  protected _fileSizeFilter(item:File):boolean {\r\n    return !(this.maxSize && item.size > this.maxSize);\r\n  }\r\n\r\n  /** browsers try hard to conceal data about file drags, this tends to undo that */\r\n  filesToWriteableObject( files:File[] ):dragMeta[]{\r\n    const jsonFiles:dragMeta[] = []\r\n    for(let x=0; x < files.length; ++x){\r\n      jsonFiles.push({\r\n        type:files[x].type,\r\n        kind:files[x][\"kind\"]\r\n      })\r\n    }\r\n    return jsonFiles\r\n  }\r\n}\r\n","import { Directive, Input } from \"@angular/core\"\r\nimport { ngf } from \"./ngf.directive\"\r\n\r\n@Directive({\r\n  selector: \"[ngfSelect]\",\r\n  exportAs: \"ngfSelect\"\r\n})\r\nexport class ngfSelect extends ngf {\r\n  @Input() selectable:any = true\r\n}","import {\r\n  Directive, EventEmitter,\r\n  HostListener, Input, Output\r\n} from '@angular/core';\r\nimport { ngf, dragMeta } from \"./ngf.directive\"\r\n\r\n@Directive({\r\n  selector: \"[ngfDrop]\",\r\n  exportAs: \"ngfDrop\"\r\n})\r\nexport class ngfDrop extends ngf {\r\n  @Output() fileOver:EventEmitter<any> = new EventEmitter();\r\n\r\n  @Input() validDrag:boolean = false\r\n  @Output() validDragChange:EventEmitter<boolean> = new EventEmitter()\r\n\r\n  @Input() invalidDrag = false\r\n  @Output() invalidDragChange:EventEmitter<boolean> = new EventEmitter()\r\n\r\n  @Input() dragFiles !: dragMeta[]\r\n  @Output() dragFilesChange:EventEmitter<dragMeta[]> = new EventEmitter()\r\n\r\n  @HostListener('drop', ['$event'])\r\n  onDrop(event:Event):void {\r\n    if(this.fileDropDisabled){\r\n      this.stopEvent(event);\r\n      return\r\n    }\r\n\r\n    this.closeDrags()\r\n    let files = this.eventToFiles(event)\r\n\r\n    if(!files.length)return\r\n\r\n    this.stopEvent(event);\r\n    this.handleFiles(files)\r\n  }\r\n\r\n  handleFiles(files:File[]){\r\n    this.fileOver.emit(false)//turn-off dragover\r\n    super.handleFiles(files)\r\n  }\r\n\r\n  @HostListener('dragover', ['$event'])\r\n  onDragOver(event:Event):void {\r\n    if(this.fileDropDisabled){\r\n      this.stopEvent(event);\r\n      return\r\n    }\r\n\r\n    const transfer = this.eventToTransfer(event)\r\n\r\n    let files = this.eventToFiles(event)\r\n\r\n    let jsonFiles = this.filesToWriteableObject(files)\r\n    this.dragFilesChange.emit( this.dragFiles=jsonFiles )\r\n\r\n    if( files.length ){\r\n      this.validDrag = this.isFilesValid(files)\r\n    }else{\r\n      //Safari, IE11 & some browsers do NOT tell you about dragged files until dropped. Always consider a valid drag\r\n      this.validDrag = true\r\n    }\r\n\r\n    this.validDragChange.emit(this.validDrag)\r\n\r\n    this.invalidDrag = !this.validDrag\r\n    this.invalidDragChange.emit(this.invalidDrag)\r\n\r\n    transfer.dropEffect = 'copy'//change cursor and such\r\n    this.stopEvent(event)\r\n    this.fileOver.emit(true)\r\n  }\r\n\r\n  closeDrags(){\r\n    delete this.validDrag\r\n    this.validDragChange.emit(this.validDrag)\r\n    this.invalidDrag = false\r\n    this.invalidDragChange.emit(this.invalidDrag)\r\n    delete this.dragFiles\r\n    this.dragFilesChange.emit( this.dragFiles )\r\n  }\r\n\r\n  @HostListener('dragleave', ['$event'])\r\n  onDragLeave(event:Event):any {\r\n    if(this.fileDropDisabled){\r\n      this.stopEvent(event);\r\n      return\r\n    }\r\n    \r\n    this.closeDrags()\r\n\r\n    if ((this as any).element) {\r\n      if (event.currentTarget === (this as any).element[0]) {\r\n        return;\r\n      }\r\n    }\r\n\r\n    this.stopEvent(event);\r\n    this.fileOver.emit(false);\r\n  }\r\n}","import { Directive, ElementRef, Input } from '@angular/core';\r\nimport { dataUrl } from './fileTools';\r\n\r\n@Directive({selector: '[ngfBackground]'})\r\nexport class ngfBackground {\r\n  @Input('ngfBackground') file:any\r\n\r\n  constructor(public ElementRef:ElementRef){}\r\n\r\n  ngOnChanges( _changes:any ){\r\n    dataUrl(this.file)\r\n    .then(src=>{\r\n      const urlString = 'url(\\'' + (src || '') + '\\')'\r\n      this.ElementRef.nativeElement.style.backgroundImage = urlString\r\n    })\r\n  }\r\n}\r\n","import { Directive, EventEmitter, Output, Input } from '@angular/core';\r\n\r\n@Directive({selector: 'ngfUploadStatus'})\r\nexport class ngfUploadStatus {\r\n  @Input() percent:number = 0\r\n  @Output() percentChange:EventEmitter<number> = new EventEmitter()\r\n  @Input() httpEvent !: Event\r\n\r\n  ngOnChanges( changes ){\r\n    if( changes.httpEvent && changes.httpEvent.currentValue ){\r\n      const event = changes.httpEvent.currentValue\r\n      if (event.loaded && event.total) {\r\n        setTimeout(()=>{\r\n          this.percent = Math.round(100 * event.loaded / event.total);\r\n          this.percentChange.emit( this.percent )\r\n        }, 0)\r\n      }\r\n    }\r\n  }\r\n}","import {\r\n  IterableDiffer,\r\n  IterableDiffers,\r\n  Directive, EventEmitter,\r\n  Output, Input\r\n} from '@angular/core';\r\n\r\n@Directive({selector: 'ngfFormData'})\r\nexport class ngfFormData {\r\n  @Input() files !: File[]\r\n  @Input() postName:string = \"file\"\r\n  @Input() fileName !: string//force file name\r\n\r\n  @Input() FormData:FormData = new FormData()\r\n  @Output() FormDataChange:EventEmitter<FormData> = new EventEmitter()\r\n\r\n  differ:IterableDiffer<{}>\r\n\r\n  constructor(IterableDiffers: IterableDiffers){\r\n    this.differ = IterableDiffers.find([]).create()\r\n  }\r\n\r\n  ngDoCheck(){\r\n    var changes = this.differ.diff( this.files );\r\n\r\n    if (changes) {\r\n      setTimeout(()=>this.buildFormData(), 0)\r\n    }\r\n  }\r\n\r\n  buildFormData(){\r\n    const isArray = typeof(this.files)==='object' && this.files.constructor===Array\r\n\r\n    if( isArray ){\r\n      this.FormData = new FormData()\r\n      const files = this.files || []\r\n      files.forEach(file=>\r\n        this.FormData.append(this.postName, file, this.fileName||file.name)\r\n      )\r\n      this.FormDataChange.emit( this.FormData )\r\n    }else{\r\n      delete this.FormData\r\n    }\r\n  }\r\n}","import { Directive, ElementRef, Input } from '@angular/core';\r\nimport { dataUrl } from './fileTools';\r\n\r\n@Directive({ selector: '[ngfSrc]' })\r\nexport class ngfSrc {\r\n  @Input('ngfSrc') file: any\r\n\r\n  constructor(public ElementRef: ElementRef) { }\r\n\r\n  ngOnChanges(_changes: any) {\r\n    dataUrl(this.file)\r\n    .then(src=>\r\n      this.ElementRef.nativeElement.src = src\r\n    )\r\n  }\r\n}\r\n","import { CommonModule } from '@angular/common';\r\nimport { NgModule } from '@angular/core';\r\n\r\nimport { ngfBackground } from './ngfBackground.directive';\r\nimport { ngfDrop } from './ngfDrop.directive';\r\nimport { ngf } from './ngf.directive';\r\nimport { ngfSelect } from './ngfSelect.directive';\r\nimport { ngfUploadStatus } from './ngfUploadStatus.directive';\r\nimport { ngfFormData } from './ngfFormData.directive';\r\nimport { ngfSrc } from './ngfSrc.directive';\r\n//import{ HttpModule } from '@angular/http';\r\n\r\nconst declarations = [\r\n  ngfDrop,\r\n  ngfSelect,\r\n  ngfBackground,\r\n  ngfSrc,\r\n  ngfUploadStatus,\r\n  ngfFormData,\r\n  ngf\r\n]\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule\r\n    //,HttpModule\r\n  ],\r\n  declarations: declarations,\r\n  exports: declarations//[HttpModule, ...declarations]\r\n}) export class ngfModule {}","/*\n * Public API Surface of angular-file\n */\n\nexport * from './file-upload/ngfSelect.directive';\nexport * from './file-upload/ngfDrop.directive';\nexport * from './file-upload/ngf.directive';\nexport * from './file-upload/ngf.module';\nexport { ngfBackground } from './file-upload/ngfBackground.directive';\nexport { ngfSrc } from './file-upload/ngfSrc.directive';\nexport { ngfUploadStatus } from './file-upload/ngfUploadStatus.directive';\nexport { ngfFormData } from './file-upload/ngfFormData.directive';","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":"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"}